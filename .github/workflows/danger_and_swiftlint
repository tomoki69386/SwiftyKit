name: Danger and SwiftLint

on: [push]

jobs:
  build:

    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v1
    
    - uses: actions/cache@v1.0.3
      id: bundleCache
      with:
        path: vendor/bundle
        key: v1-gem-${{ hashFiles(format('{0}{1}', github.workspace, '/Gemfile.lock')) }}
        restore-keys: |
          v1-gem-${{ hashFiles(format('{0}{1}', github.workspace, '/Gemfile.lock')) }}
      
    - name: Select Xcode version
      run: sudo xcode-select -s '/Applications/Xcode_11.app/Contents/Developer
    
    - name: bundle install
      if: steps.bundleCache.outputs.cache-hit != 'true'
      run: bundle install --path vendor/bundle

    - name: danger_and_swiftlint
      run: bundle exec danger
